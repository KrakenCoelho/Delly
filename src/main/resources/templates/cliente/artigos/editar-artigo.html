<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Mon Oct 30 2023 11:20:54 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="653f6fb73b02deefdbb8e68b" data-wf-site="60e5d747e768b207c1679675">
<head>
  <meta charset="utf-8">
  <title>Editar artigo</title>
  <meta content="Editar artigo" property="og:title">
  <meta content="Editar artigo" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../../../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../../../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../../../css/delly-menus-qr-code.webflow.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../../../images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="../../../images/webclip.png" rel="apple-touch-icon">
  
  <script src="//cdn.ckeditor.com/4.20.1/standard/ckeditor.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.1/dist/sweetalert2.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.1/dist/sweetalert2.min.js"></script>
  
  
</head>
<body>
  <section>
    <div data-animation="over-right" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav">
      <div class="contain">
        <a href="../../../cliente/dashboard" class="brand w-nav-brand"></a>
        <nav role="navigation" class="nav-menu w-nav-menu">
          <a href="../../../cliente/dashboard" class="nav-link w-nav-link">Início</a>
          <a href="../../../cliente/definicoes-gerais/meu-qr-code" class="nav-link w-nav-link">Meu QR Code</a>
          <a href="../../../cliente/artigos/artigos-main" class="nav-link w-nav-link">Meus Artigos</a>
          <a href="../../../cliente/categorias/categorias-main" class="nav-link w-nav-link">Categorias</a>
          <a href="../../../cliente/avaliacoes/avaliacoes-main" class="nav-link w-nav-link">Avaliações</a>
          <a href="../../../cliente/definicoes-gerais/definicoes" class="nav-link w-nav-link">Definições</a>
       	    <a href="/logout" class="nav-link w-nav-link">Sair</a>
        </nav>
        <div class="menu-button w-nav-button">
          <div class="w-icon-nav-menu"></div>
        </div>
      </div>
    </div>
    <div class="shadow-1"></div>
  </section>
  <section class="section-7">
    <div class="contain">
      <div class="div-block-138">
        <div class="div-block-139">
          <a href="javascript:history.back()" class="back-now">e</a>
          <div class="text-block-44">Editar artigo</div>
        </div>
        <div></div>
      </div>
      <div class="form-block-4 w-form">
        <form th:action="'/editartigo/'+${id}" th:each="art:${artigo}" th:obeject="${artigo}" id="email-form" name="email-form" data-name="Email Form" method="POST" class="w-clearfix" data-wf-page-id="653f6fb73b02deefdbb8e68b" data-wf-element-id="b6965ba1-6c38-2903-4afb-88e67be9290a">
          <div class="div-block-133">
          <label for="name-2" class="field-label-3">Nome do artigo</label>
          <input th:value="${art[1]}" required type="text" class="text-field-4 w-input" maxlength="256" name="nome_ar" data-name="Name 2" placeholder="" id="name-2">
          <input th:value="${art[0]}" required type="hidden" class="text-field-4 w-input" maxlength="256" name="id_ar" data-name="Name 2" placeholder="" id="id_ar">
          </div>
          <div class="div-block-133">
          <label for="name-2" class="field-label-3">Preço</label>
          <input th:value="${art[2]}" required type="text" class="text-field-4 w-input" maxlength="256" name="preco" data-name="Name 2" placeholder="KZ" id="preco"></div>
          <div class="div-block-133">
          <label  for="field" class="field-label-3">Descrição</label>
          <textarea th:text="${art[3]}" required data-name="Field" maxlength="5000" id="descricao" name="descricao_ar" placeholder="Pequena descrição do artigo" class="text-field-4 long w-input"></textarea></div>
          <div class="div-block-133">
          <label for="name-3" class="field-label-3">Categoria</label>
          <select required id="categoria" name="acategoria_id" data-name="Escolher Categoria" class="text-field-4 w-select">
              <option selected th:value="${art[4]}"> [[${art[5]}]]</option>
               <option th:each="cat:${categorias}" th:value="${cat[0]}"> [[${cat[1]}]]</option>
            </select></div>
          <div class="div-block-133">
          <label for="name-3" class="field-label-3">Subcategoria</label>
          <select id="subcategoria" name="asubcategoria_id" data-name="Escolher Categoria 2" class="text-field-4 w-select">
              <option selected th:value="${art[6]}"> [[${art[7]}]]</option>
              
            </select></div>
          <button type="submit" class="button-2 blue float-right all w-button">Guardar</button>
        </form>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        <div class="w-form-fail">
          <div>Oops! Something went wrong while submitting the form.</div>
        </div>
      </div>
      <div>
        <div class="div-block-140">
          <button th:onclick="javascript:apagarart(this.getAttribute('data-id'))" th:attr="data-id=${id}" class="button-2 apagar w-button">Apagar</button>
        </div>
      </div>
    </div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=60e5d747e768b207c1679675" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../../../js/webflow.js" type="text/javascript"></script>
   <script>
//when the form is submitted 
  $('.form-important-class').submit(()=>{	
  	// wait 1000ms (so we have time to see the success wrapper show)
  	setTimeout(()=>{
      	// click our .form-success-trigger
        // this class has an Interaction on it that runs our Lottie icon animation
      	$('.form-success-trigger').click();
    },20000);
    // NICE!!!!!!!!
  });
  
  CKEDITOR.replace( 'descricao');
  
  var id = window.btoa($("#id_ar").val());
  
  $(document).ready(function() {
		    $('form').submit(function(event) {
		        event.preventDefault(); // Evita que o formulário seja enviado normalmente
				
				var a = CKEDITOR.instances.descricao.getData();
 				$("#descricao").val(a);	
				//alert(a);
		        const loadingSwal = Swal.fire({
		            title: "Aguarde...",
		            didOpen: () => {
		                Swal.showLoading()
		            },
		        });

		        // Crie um objeto FormData para o formulário
		        const formData = new FormData(this);

		        // Envie os dados via AJAX usando FormData
		        const url = "/editartigo/"+id;
		        $.ajax({
		            type: "POST",
		            url: url,
		            data: formData,
		            processData: false, // Não processar o FormData (já está em um formato adequado para envio)
		            contentType: false, // Não definir o tipo de conteúdo (o navegador irá definir como 'multipart/form-data')
		            success: function(data) {
		                // Esconda a animação de carregamento
		                loadingSwal.close();

		                // Lógica para manipular a resposta do servidor
		                if (data === "index") {
		                    Swal.fire({
		                        title: "Sessão expirada",
		                        text: "",
		                        icon: "info"
		                    });
		                } else {
		                    Swal.fire({
		                        title: "Artigo Editado",
		                        text: "",
		                        timer: 2500,
		                        icon: "success"
		                    }).then(()=>{window.location.href = "/cliente/categorias/categoria-ind/"+data;})
		                      }
		            },
		            error: function(xhr, textStatus, errorThrown) {
		                // Esconda a animação de carregamento
		                loadingSwal.close();

		                // Mostre a mensagem de erro
		                Swal.fire({
		                    title: "Erro!",
		                    text: xhr.responseText,
		                    icon: "error"
		                });
		            }
		        });
		    });
		});

  
  $('#categoria').change(  		
	         function() {
	      	   $.getJSON("/subespec", {
	      		 categoria_id :$(this).val(),
	                 ajax : 'true'
	             	}, function(data) { 	             		
	             		var len = data.length,html="";
	           if(len>0){               	 
	             	$.each(data,function(index, scat) { 
	             		html += '<option value="' + scat[0]+ '">'
	                   + scat[1]+ '</option>';
	             	});
	           
	           	$('#subcategoria').html(html);                              
	                 }else{                            	  
	                 	$('#subcategoria').html('<option value=""></option>');   
	                 }
	       });
	 });
  
  function apagarart(param){
		//alert(param);
		Swal.fire({
			  title: 'Tem a certeza ?',
			  text: "Este processo é irreversivel",
			  icon: 'question',
			  showCancelButton: true,
			  confirmButtonColor: '#3085d6',
			  cancelButtonColor: '#d33',
			  confirmButtonText: 'Sim, eliminar artigo!'
			}).then((result) => {
			  if (result.isConfirmed) {
				  var delay=1300;
				  setTimeout(function(){
				  //window.location.href='/apagarempresa/'+ $('#id_empresax').val();
					  window.location.href='/apagarartigo/'+ param;
				  },delay);
			    Swal.fire(
			      'Artigo eliminada!',
			      '',
			      'success'
			    )
			  }
			})
		
	}
  
  
  document.getElementById('preco').addEventListener('input', function (e) {
	  e.target.value = e.target.value.replace(/[^0-9]/g, '');
	});
  
  </script>
</body>
</html>